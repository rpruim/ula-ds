<!DOCTYPE html>
<html lang="en-US" dir="ltr">
<!--********************************************-->
<!--*       Generated from PreTeXt source      *-->
<!--*                                          *-->
<!--*         https://pretextbook.org          *-->
<!--*                                          *-->
<!--********************************************-->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="robots" content="noindex, nofollow">
<script>// Make *any* pre with class 'sagecell-python' an executable Sage cell
// Their results will be linked, only within language type
sagecell.makeSagecell({
  "inputLocation": "pre.sagecell-python",
  "linked": true,
  "linkKey": "linked-python",
  "autoeval": false,
  "languages": [
    "python"
  ],
  "evalButtonText": "Evaluate (Python)"
});
</script>
</head>
<body class="ignore-math">
<h5 class="heading"><span class="type">Paragraph</span></h5>
<div class="para logical">
<div class="para">Notices that although one stock has a higher value, stocks 0 and 3 appear to be related since they seem to rise and fall at roughly similar ways.  We often say that such series are <dfn class="terminology">correlated</dfn>, and we would like to measure the degree to which they are correlated.</div>
<ol class="decimal">
<li>
<div class="para">In order to compare the ways in which they rise and fall, we will first  <dfn class="terminology">demean</dfn> each time series;  that is, for each time series, we will subtract its average value to obtain a new time series.</div>
<pre class="ptx-sagecell sagecell-python" id="sage-201"><script type="text/x-sage">stocks0 = stocks - stocks.mean(axis = 0)
stocks0_long = pd.melt(stocks0, id_vars="day", var_name = "stock", value_name="price")
so.Plot(stocks_long, x = "day", y = "price", color = "stock").add(so.Lines()).show()
</script></pre>
</li>
<li>
<div class="para logical">
<div class="para">If the demeaned series are <span class="process-math">\(\tilde{\svec}_1\)</span> and <span class="process-math">\(\tilde{\svec}_2\text{,}\)</span> then the <dfn class="terminology">correlation</dfn> between <span class="process-math">\(\svec_1\)</span> and <span class="process-math">\(\svec_2\)</span> is defined to be </div>
<div class="displaymath process-math">
\begin{equation*}
\corr(\svec_1, \svec_2) =
\frac{\tilde{\svec}_1\cdot\tilde{\svec}_2}
{\len{\tilde{\svec}_1}\len{\tilde{\svec}_2}} =
\frac{\len{\tilde{\svec}_1}\len{\tilde{\svec}_2} \cos \theta}
{\len{\tilde{\svec}_1}\len{\tilde{\svec}_2}} = \cos \theta
\end{equation*}
</div>
<div class="para">where <span class="process-math">\(\theta\)</span> is the angle between <span class="process-math">\(\tilde{\svec_1}\)</span> and <span class="process-math">\(\tilde{\svec_2}\text{.}\)</span> That is, the correlation equals the cosine of the angle between the demeaned time series. Among other things, this implies that <span class="process-math">\(\corr(\svec_1,\svec_2)\)</span> is always between -1 and 1.</div>
</div>
<div class="para">Find the correlation between each pair of stocks.</div>
<pre class="ptx-sagecell sagecell-python" id="sage-202"><script type="text/x-sage">
</script></pre>
</li>
<li>
<div class="para">Suppose that two time series are such that their demeaned time series are scalar multiples of one another, as in <a href="" class="xref" data-knowl="./knowl/fig-correlation.html" title="Figure 6.1.20">FigureÂ 6.1.20</a>
</div>
<figure class="figure figure-like"><div class="sidebyside"><div class="sbsrow" style="margin-left:5%;margin-right:5%;">
<div class="sbspanel top" style="width:44.4444444444444%;"><img src="external/images/correlation-pos.svg" role="img" class="contained"></div>
<div class="sbspanel top" style="width:44.4444444444444%;"><img src="external/images/correlation-neg.svg" role="img" class="contained"></div>
</div></div>
<figcaption><span class="type">Figure</span><span class="space"> </span><span class="codenumber">6.1.20<span class="period">.</span></span><span class="space"> </span>On the left, the demeaned time series are positive scalar multiples of one another.  On the right, they are negative scalar multiples.</figcaption></figure><div class="para">For instance, suppose we have time series <span class="process-math">\(\tvec_1\)</span> and <span class="process-math">\(\tvec_2\)</span> whose demeaned time series <span class="process-math">\(\tilde{\tvec}_1\)</span> and <span class="process-math">\(\tilde{\tvec}_2\)</span> are positive scalar multiples of one another.  What is the angle between the demeaned vectors?  What does this say about the correlation <span class="process-math">\(\corr(\tvec_1, \tvec_2)\text{?}\)</span>
</div>
</li>
<li><div class="para">Suppose the demeaned time series <span class="process-math">\(\tilde{\tvec}_1\)</span> and <span class="process-math">\(\tilde{\tvec}_2\)</span> are negative scalar multiples of one another, what is the angle between the demeaned vectors?  What does this say about the correlation <span class="process-math">\(\corr(\tvec_1, \tvec_2)\text{?}\)</span>
</div></li>
<li><div class="para">Which pair of stocks had the largest correlation?  How is this reflected in the plot?</div></li>
<li><div class="para">Which pair of stocks had the smallest (most negative) correlation? How is this reflected in the plot?</div></li>
<li><div class="para">Which pair of stocks had a correlation closest to 0? How is this reflected in the plot?</div></li>
<li>
<div class="para">The correlation is important enough that numpy can do all the work of computing correlations for each pair of rows (default) or columns (what we want here) in a matrix.  The result is a matrix containing all the pairwise correlations. </div>
<pre class="ptx-sagecell sagecell-python" id="sage-203"><script type="text/x-sage">print("correlations"); print() 
print(np.corrcoef(stocks, rowvar = False))
</script></pre>
<div class="para logical"><ul class="disc">
<li><div class="para">Explain why the shape of the correlation matrix is what it is. What shape would it have been if we had not used <code class="code-inline tex2jax_ignore">rowvar = False</code>?</div></li>
<li><div class="para">Explain why this matrix is symmetric.</div></li>
<li><div class="para">Explain why the diagonal values are what they are.</div></li>
</ul></div>
</li>
</ol>
</div>
<span class="incontext"><a href="sec-dot-product.html#p-5778" class="internal">in-context</a></span>
</body>
</html>
